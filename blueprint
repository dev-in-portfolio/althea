Qwik CardForge — Qwik app blueprint (card composer + publish) + Neon backend

What it is

Qwik CardForge is a Qwik City app for composing ordered cards (text/image/embed/quote) into a page, saving drafts, and publishing a public read-only URL. It’s a real editor/publisher workflow that stays fast because Qwik only wakes up the parts you touch.


---

Shared backbone (required in every Neon-backed Qwik app)

Rule: Qwik must never connect to Neon directly.
Flow: Qwik → API server → Neon (Postgres)

Identity (v1, no auth):

Qwik generates device_key UUID in localStorage.

Sends X-Device-Key with each API call.

API resolves to user_id.


Server invariants

DATABASE_URL env-only

Parameterized SQL only

CORS configured

Payload size caps



---

Data model (Neon Postgres)

sql/001_qwik_cardforge.sql

create extension if not exists pgcrypto;

create table if not exists users (
  id uuid primary key default gen_random_uuid(),
  device_key text not null unique,
  created_at timestamptz not null default now()
);

create table if not exists qcf_pages (
  id uuid primary key default gen_random_uuid(),
  user_id uuid not null references users(id) on delete cascade,
  title text not null,
  slug text not null,
  status text not null default 'draft' check (status in ('draft','published')),
  published_slug text null unique,
  created_at timestamptz not null default now(),
  updated_at timestamptz not null default now(),
  unique(user_id, slug)
);

create table if not exists qcf_cards (
  id uuid primary key default gen_random_uuid(),
  page_id uuid not null references qcf_pages(id) on delete cascade,
  type text not null check (type in ('text','image','embed','quote')),
  ord int not null,
  title text not null default '',
  body text not null default '',
  image_url text not null default '',
  embed_url text not null default '',
  created_at timestamptz not null default now(),
  unique(page_id, ord)
);

create index if not exists idx_qcf_pages_user_status on qcf_pages(user_id, status, updated_at desc);
create index if not exists idx_qcf_cards_page_ord on qcf_cards(page_id, ord);


---

Publish rule (MVP)

Publish sets published_slug once (server-generated).

Public route: /p/:published_slug

MVP behavior: public reflects latest saved state (no snapshot versioning)



---

API surface

Base: /api/qcf

Pages

GET /pages

POST /pages { title, slug }

GET /pages/:id (includes ordered cards)

PATCH /pages/:id { title?, slug?, status? }

DELETE /pages/:id


Cards

POST /pages/:id/cards { type, ord, title?, body?, imageUrl?, embedUrl? }

PATCH /cards/:cardId { ord?, title?, body?, imageUrl?, embedUrl? }

DELETE /cards/:cardId


Public

GET /public/:published_slug


Caps

Max cards per page: 500

Max card body length: 20k



---

Qwik City routes

/ Dashboard (drafts/published)

/edit/:id Editor

/p/:publishedSlug Public view



---

UI/UX (MVP)

Dashboard

create page

list pages

open editor


Editor

left: card list with ord + type

right: card editor form

preview panel

reorder: up/down buttons (drag later)


Publish bar

publish/unpublish toggle

shows public link when published


Public view

read-only render

minimal client JS (no editor code)



---

Performance approach (boring)

Use Qwik signals/stores for editor state

Only fetch page data for the route you’re on

Keep previews server-rendered where possible



---

Smoke tests

1. Create page


2. Add 5 cards, reorder them


3. Save and reload editor: order persists


4. Publish and open public URL: works without device_key


5. Edit a card: public reflects updates




---

Done definition

Done = Qwik editor builds/persists ordered card pages to Neon via API and publishes a public read-only route.
