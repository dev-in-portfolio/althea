(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[811],{8959:function(e,s,t){Promise.resolve().then(t.bind(t,3297))},3297:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return r},dynamic:function(){return l}});var n=t(8247),a=t(888),i=t(9644);let l="force-dynamic";function r(){let e=(0,i.N)(),[s,t]=(0,a.useState)([]),[l,r]=(0,a.useState)(""),[c,o]=(0,a.useState)(""),[d,u]=(0,a.useState)(""),[h,f]=(0,a.useState)({});async function m(){let{data:s,error:n}=await e.from("sessions").select("id,started_at,ended_at,duration_seconds,tag,feel,note").order("started_at",{ascending:!1});if(n){r(n.message);return}t(s||[])}async function g(n){if(!confirm("Delete this session?"))return;let{error:a}=await e.from("sessions").delete().eq("id",n);if(a){r(a.message);return}t(s.filter(e=>e.id!==n))}async function N(){if(!confirm("Delete selected sessions?"))return;let n=Object.entries(h).filter(e=>{let[,s]=e;return s}).map(e=>{let[s]=e;return s});if(!n.length)return;let{error:a}=await e.from("sessions").delete().in("id",n);if(a){r(a.message);return}t(s.filter(e=>!n.includes(e.id))),f({})}return(0,a.useEffect)(()=>{e.auth.getSession().then(e=>{let{data:s}=e;s.session||(window.location.href="/login")})},[]),(0,a.useEffect)(()=>{m()},[]),(0,n.jsxs)("div",{className:"grid",children:[(0,n.jsxs)("div",{className:"card",children:[(0,n.jsx)("h2",{children:"Session history"}),(0,n.jsx)("p",{className:"muted",children:"Review and clean up your session log."}),(0,n.jsxs)("div",{className:"toolbar",style:{marginTop:12},children:[(0,n.jsx)("input",{className:"input",placeholder:"Search tag",value:c,onChange:e=>o(e.target.value)}),(0,n.jsxs)("select",{className:"input",value:d,onChange:e=>u(e.target.value),children:[(0,n.jsx)("option",{value:"",children:"All feels"}),(0,n.jsx)("option",{value:"flow",children:"Flow"}),(0,n.jsx)("option",{value:"neutral",children:"Neutral"}),(0,n.jsx)("option",{value:"drag",children:"Drag"})]}),(0,n.jsx)("button",{className:"btn danger",onClick:N,children:"Delete selected"})]}),l&&(0,n.jsx)("p",{className:"muted",style:{marginTop:12},children:l})]}),0===s.length?(0,n.jsx)("div",{className:"card",children:(0,n.jsx)("p",{className:"muted",children:"No sessions logged."})}):s.filter(e=>{let s=!c||e.tag.toLowerCase().includes(c.toLowerCase()),t=!d||e.feel===d;return s&&t}).map(e=>(0,n.jsxs)("div",{className:"card",children:[(0,n.jsxs)("div",{className:"toolbar",style:{justifyContent:"space-between"},children:[(0,n.jsxs)("div",{className:"toolbar",children:[(0,n.jsx)("input",{type:"checkbox",checked:!!h[e.id],onChange:s=>f(t=>({...t,[e.id]:s.target.checked}))}),(0,n.jsx)("strong",{children:e.tag})]}),(0,n.jsx)("button",{className:"btn danger",onClick:()=>g(e.id),children:"Delete"})]}),(0,n.jsxs)("p",{className:"muted",children:[e.feel," \xb7 ",Math.round(e.duration_seconds/60)," min"]}),e.note&&(0,n.jsx)("p",{className:"muted",children:e.note}),(0,n.jsx)("p",{className:"muted",children:new Date(e.started_at).toLocaleString()})]},e.id))]})}},9644:function(e,s,t){"use strict";t.d(s,{N:function(){return l}});var n=t(4286),a=t(461);let i=null;function l(){if(i)return i;let e=a.env.NEXT_PUBLIC_SUPABASE_URL||"http://localhost:54321",s=a.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"anon-key";return i=(0,n.eI)(e,s,{auth:{persistSession:!0,autoRefreshToken:!0}})}}},function(e){e.O(0,[775,501,539,744],function(){return e(e.s=8959)}),_N_E=e.O()}]);