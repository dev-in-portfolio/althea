(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{881:function(e,t,s){Promise.resolve().then(s.bind(s,6957))},6957:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i},dynamic:function(){return r}});var a=s(8247),n=s(888),l=s(9644);let r="force-dynamic";function i(){let e=(0,l.N)(),[t,s]=(0,n.useState)(null),[r,i]=(0,n.useState)("Deep work"),[o,c]=(0,n.useState)("neutral"),[d,u]=(0,n.useState)(""),[m,g]=(0,n.useState)(""),[h,f]=(0,n.useState)([]),[p]=(0,n.useState)([{tag:"Deep work",feel:"flow",note:""},{tag:"Admin",feel:"neutral",note:""},{tag:"Meetings",feel:"drag",note:""}]),N=(0,n.useMemo)(()=>t?Math.floor((Date.now()-t.getTime())/1e3):0,[t]),x=(0,n.useMemo)(()=>h.reduce((e,t)=>(e[t.feel]+=1,e),{drag:0,neutral:0,flow:0}),[h]);async function j(){let{data:t,error:s}=await e.from("sessions").select("id,started_at,ended_at,duration_seconds,tag,feel,note").order("started_at",{ascending:!1}).limit(5);if(s){g(s.message);return}f(t||[])}async function v(){if(!t)return;let a=new Date,n=Math.max(0,Math.floor((a.getTime()-t.getTime())/1e3));if(n<60){g("Session too short (min 60s).");return}let{data:l}=await e.auth.getUser();if(!l.user){g("Session expired.");return}let{data:i,error:c}=await e.from("sessions").insert({user_id:l.user.id,started_at:t.toISOString(),ended_at:a.toISOString(),duration_seconds:n,tag:r.trim()||"Session",feel:o,note:d.trim()}).select("id,started_at,ended_at,duration_seconds,tag,feel,note").single();if(c){g(c.message);return}f([i,...h].slice(0,5)),s(null),u("")}return(0,n.useEffect)(()=>{e.auth.getSession().then(e=>{let{data:t}=e;t.session||(window.location.href="/login")})},[]),(0,n.useEffect)(()=>{if(!t)return;let e=setInterval(()=>{s(e=>e?new Date(e.getTime()):e)},1e3);return()=>clearInterval(e)},[t]),(0,n.useEffect)(()=>{j()},[]),(0,a.jsxs)("div",{className:"grid",children:[(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h2",{children:"Session Logger"}),(0,a.jsx)("p",{className:"muted",children:"Track focused work and feelings."}),(0,a.jsxs)("div",{className:"toolbar",style:{marginTop:12},children:[(0,a.jsx)("input",{className:"input",placeholder:"Tag",value:r,onChange:e=>i(e.target.value)}),(0,a.jsxs)("select",{className:"input",value:o,onChange:e=>c(e.target.value),children:[(0,a.jsx)("option",{value:"drag",children:"Drag"}),(0,a.jsx)("option",{value:"neutral",children:"Neutral"}),(0,a.jsx)("option",{value:"flow",children:"Flow"})]}),(0,a.jsx)("button",{className:"btn secondary",onClick:function(){if(0===h.length)return;let e=h[0];i(e.tag),c(e.feel),u(e.note||"")},disabled:0===h.length,children:"Repeat last"})]}),(0,a.jsx)("textarea",{placeholder:"Notes",value:d,onChange:e=>u(e.target.value),style:{marginTop:12}}),(0,a.jsx)("div",{className:"toolbar",style:{marginTop:12},children:p.map(e=>(0,a.jsxs)("button",{className:"btn secondary",onClick:()=>{i(e.tag),c(e.feel),u(e.note)},children:[e.tag," \xb7 ",e.feel]},e.tag))}),(0,a.jsxs)("div",{className:"toolbar",style:{marginTop:12},children:[(0,a.jsx)("button",{className:"btn",onClick:function(){t||s(new Date)},disabled:!!t,children:"Start"}),(0,a.jsx)("button",{className:"btn secondary",onClick:v,disabled:!t,children:"Stop"}),(0,a.jsxs)("span",{className:"badge",children:["Elapsed ",Math.floor(N/60),"m ",N%60,"s"]})]}),m&&(0,a.jsx)("p",{className:"muted",style:{marginTop:12},children:m})]}),(0,a.jsxs)("div",{className:"card alt",children:[(0,a.jsx)("h3",{children:"Recent sessions"}),(0,a.jsxs)("div",{className:"toolbar",style:{marginTop:8},children:[(0,a.jsxs)("span",{className:"badge",children:["Flow ",x.flow]}),(0,a.jsxs)("span",{className:"badge",children:["Neutral ",x.neutral]}),(0,a.jsxs)("span",{className:"badge",children:["Drag ",x.drag]})]}),0===h.length?(0,a.jsx)("p",{className:"muted",children:"No sessions yet."}):(0,a.jsx)("div",{className:"grid",style:{marginTop:12},children:h.map(e=>(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("div",{className:"toolbar",style:{justifyContent:"space-between"},children:[(0,a.jsx)("strong",{children:e.tag}),(0,a.jsx)("span",{className:"badge",children:e.feel})]}),(0,a.jsxs)("p",{className:"muted",children:[Math.round(e.duration_seconds/60)," min"]}),(0,a.jsx)("p",{className:"muted",children:new Date(e.started_at).toLocaleString()})]},e.id))})]})]})}},9644:function(e,t,s){"use strict";s.d(t,{N:function(){return r}});var a=s(4286),n=s(461);let l=null;function r(){if(l)return l;let e=n.env.NEXT_PUBLIC_SUPABASE_URL||"http://localhost:54321",t=n.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"anon-key";return l=(0,a.eI)(e,t,{auth:{persistSession:!0,autoRefreshToken:!0}})}}},function(e){e.O(0,[775,501,539,744],function(){return e(e.s=881)}),_N_E=e.O()}]);